{"version":3,"file":"dx-dropdown-owner-24.2.js","sources":["../../Scripts/common/dx-dropdown-owner.ts"],"sourcesContent":["import { DxUIElement } from \"./dx-ui-element\";\r\nimport { PortableElementsChangedEvent } from \"../popup/portal\";\r\nimport { PopupClosedEvent, PopupShownEvent } from \"../popup/popup\";\r\nimport { html } from \"lit\";\r\nimport EventHelper from \"../utils/eventhelper\";\r\nimport { isIAdaptiveDropDown, isILogicalChildBase, isIPopupAccessor } from \"../utils/typeguard\";\r\nexport class DxDropDownOwner extends DxUIElement {\r\n    constructor() {\r\n        super();\r\n        this.boundOnDropDownElementChangedHandler = this.onDropDownElementChanged.bind(this);\r\n        this.boundOnDropDownShownHandler = this.onDropDownShown.bind(this);\r\n        this.boundOnDropDownClosedHandler = this.onDropDownClosed.bind(this);\r\n        this.boundOnDropDownPortalElementsChangedHandler = this.onDropDownPortalElementsChanged.bind(this);\r\n        this.boundSlotChangedHandler = this.onSlotChanged.bind(this);\r\n        this.dropDownPortal = null;\r\n        this._dropDownElement = null;\r\n        this._adaptiveDropDownElement = null;\r\n    }\r\n    get dropDownElement() {\r\n        return this._dropDownElement;\r\n    }\r\n    get useMobileFocusBehaviour() {\r\n        var _a;\r\n        return ((_a = this._adaptiveDropDownElement) === null || _a === void 0 ? void 0 : _a.adaptivityEnabled) || false;\r\n    }\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this.ensureDropDownInfrastructure();\r\n        this.addEventListener(PortableElementsChangedEvent.eventName, this.boundOnDropDownElementChangedHandler);\r\n    }\r\n    disconnectedCallback() {\r\n        this.removeEventListener(PortableElementsChangedEvent.eventName, this.boundOnDropDownElementChangedHandler);\r\n        this.disposeDropDownInfrastructure();\r\n        super.disconnectedCallback();\r\n    }\r\n    render() {\r\n        return html `\r\n            <slot @slotchange=\"${this.boundSlotChangedHandler}\">\r\n            </slot>\r\n        `;\r\n    }\r\n    processCapturedKeyDownAsync(event, options) {\r\n        if (this.invokeKeyDownServerCommand(event)) {\r\n            event.preventDefault();\r\n            options.handled = true;\r\n            return Promise.resolve();\r\n        }\r\n        return super.processCapturedKeyDownAsync(event, options);\r\n    }\r\n    processCapturedPointerAsync(event, options) {\r\n        if (this.canHandlePointerDown(event)) {\r\n            options.handled = true;\r\n            return Promise.resolve();\r\n        }\r\n        return super.processCapturedPointerAsync(event, options);\r\n    }\r\n    canHandlePointerDown(_) {\r\n        return false;\r\n    }\r\n    invokeKeyDownServerCommand(_) {\r\n        return false;\r\n    }\r\n    onSlotChanged(_) {\r\n        this.disposeDropDownInfrastructure();\r\n        this.ensureDropDownInfrastructure();\r\n    }\r\n    getDropDownPortal() {\r\n        if (!this.shadowRoot)\r\n            return null;\r\n        const slot = this.shadowRoot.querySelector(\"slot\");\r\n        if (!slot)\r\n            return null;\r\n        const elements = slot.assignedNodes();\r\n        return elements.find(e => isIPopupAccessor(e));\r\n    }\r\n    onDropDownElementChanged(evt) {\r\n        if (!this.dropDownPortal)\r\n            this.ensureDropDownInfrastructure();\r\n        if (EventHelper.getOriginalSource(evt) !== this.dropDownPortal)\r\n            return;\r\n        this.disposeDropDownElement();\r\n        this.ensureDropDownElement();\r\n    }\r\n    onDropDownShown(_) {\r\n        if (this.dropDownElement && isILogicalChildBase(this.dropDownElement))\r\n            this.addLogicalChild(this.dropDownElement);\r\n    }\r\n    onDropDownClosed(_) {\r\n        if (this.dropDownElement && isILogicalChildBase(this.dropDownElement))\r\n            this.removeLogicalChild(this.dropDownElement);\r\n    }\r\n    onDropDownPortalElementsChanged(_) {\r\n        this.ensureDropDownElement();\r\n    }\r\n    ensureDropDownInfrastructure() {\r\n        var _a;\r\n        this.dropDownPortal = this.getDropDownPortal();\r\n        (_a = this.dropDownPortal) === null || _a === void 0 ? void 0 : _a.addEventListener(PortableElementsChangedEvent.eventName, this.boundOnDropDownPortalElementsChangedHandler);\r\n        this.ensureDropDownElement();\r\n    }\r\n    ensureDropDownElement() {\r\n        var _a, _b, _c;\r\n        if (!this.dropDownPortal)\r\n            return;\r\n        this._dropDownElement = (_a = this.dropDownPortal) === null || _a === void 0 ? void 0 : _a.popup;\r\n        (_b = this._dropDownElement) === null || _b === void 0 ? void 0 : _b.addEventListener(PopupShownEvent.eventName, this.boundOnDropDownShownHandler);\r\n        (_c = this._dropDownElement) === null || _c === void 0 ? void 0 : _c.addEventListener(PopupClosedEvent.eventName, this.boundOnDropDownClosedHandler);\r\n        if (this._dropDownElement && isIAdaptiveDropDown(this._dropDownElement))\r\n            this._adaptiveDropDownElement = this._dropDownElement;\r\n    }\r\n    disposeDropDownInfrastructure() {\r\n        var _a;\r\n        (_a = this.dropDownPortal) === null || _a === void 0 ? void 0 : _a.removeEventListener(PortableElementsChangedEvent.eventName, this.boundOnDropDownPortalElementsChangedHandler);\r\n        this.dropDownPortal = null;\r\n        this._adaptiveDropDownElement = null;\r\n        this.disposeDropDownElement();\r\n    }\r\n    disposeDropDownElement() {\r\n        var _a, _b;\r\n        (_a = this._dropDownElement) === null || _a === void 0 ? void 0 : _a.removeEventListener(PopupShownEvent.eventName, this.boundOnDropDownShownHandler);\r\n        (_b = this._dropDownElement) === null || _b === void 0 ? void 0 : _b.removeEventListener(PopupClosedEvent.eventName, this.boundOnDropDownClosedHandler);\r\n        this._dropDownElement = null;\r\n    }\r\n}\r\n"],"names":["html"],"mappings":"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"}