{"version":3,"file":"dx-ui-handlers-bridge-24.2.js","sources":["../../Scripts/common/dx-ui-handlers-bridge.ts"],"sourcesContent":["export const DxUIHandlersBridgeTagName = \"dxbl-ui-handlers-bridge\";\r\nexport class DxUIHandlersBridgeCommandResult {\r\n    constructor(id, result) {\r\n        this.id = id;\r\n        this.result = result;\r\n    }\r\n    processedBy(pendingCommandId) {\r\n        return this.id === pendingCommandId;\r\n    }\r\n}\r\nexport class DxUIHandlersBridge extends HTMLElement {\r\n    constructor() {\r\n        super();\r\n        this.pendingCommands = new Map();\r\n        this._value = null;\r\n    }\r\n    disposeComponent() {\r\n        this.pendingCommands.clear();\r\n    }\r\n    get value() {\r\n        return this._value;\r\n    }\r\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\r\n    send(handlerId, args, completeCallback = null) {\r\n        try {\r\n            const commandId = this.nextCommandId();\r\n            this.pendingCommands.set(commandId, completeCallback);\r\n            this._value = JSON.stringify([commandId.toString(), handlerId, args]);\r\n            this.dispatchEvent(new Event(\"change\", { bubbles: true }));\r\n            return commandId;\r\n        }\r\n        finally {\r\n            this._value = null;\r\n        }\r\n    }\r\n    static get observedAttributes() {\r\n        return [\"command-results\"];\r\n    }\r\n    attributeChangedCallback(name, oldVal, newVal) {\r\n        switch (name) {\r\n            case \"command-results\":\r\n                setTimeout(() => this.processCommandResults(newVal), 0);\r\n                break;\r\n        }\r\n    }\r\n    processCommandResults(jsonText) {\r\n        const commandResults = this.parseCommandResults(jsonText);\r\n        for (const commandResult of commandResults) {\r\n            const commandEndCallback = this.pendingCommands.get(commandResult.id);\r\n            this.pendingCommands.delete(commandResult.id);\r\n            if (commandEndCallback)\r\n                commandEndCallback(commandResult);\r\n        }\r\n    }\r\n    parseCommandResults(jsonText) {\r\n        const result = new Array();\r\n        const json = JSON.parse(jsonText);\r\n        for (const jsonItem of json.CommandResults)\r\n            result.push(new DxUIHandlersBridgeCommandResult(parseInt(jsonItem.Id), jsonItem.Result));\r\n        return result.sort((a, b) => a.id === b.id ? 0 : (a.id > b.id ? 1 : -1));\r\n    }\r\n    nextCommandId() {\r\n        if (this.pendingCommands.size === 0)\r\n            return 0;\r\n        let maxCommandId = 0;\r\n        for (const commandId of this.pendingCommands.keys()) {\r\n            if (commandId > maxCommandId)\r\n                maxCommandId = commandId;\r\n        }\r\n        return maxCommandId + 1;\r\n    }\r\n}\r\ncustomElements.define(DxUIHandlersBridgeTagName, DxUIHandlersBridge);\r\nfunction loadModule() { }\r\nexport default { loadModule };\r\n"],"names":[],"mappings":"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"}