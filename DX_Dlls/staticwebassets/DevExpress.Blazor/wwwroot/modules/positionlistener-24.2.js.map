{"version":3,"file":"positionlistener-24.2.js","sources":["../../Scripts/popup/positionlistener.ts"],"sourcesContent":["import { PositionChangingEvent } from \"./positiontracker\";\r\nimport EventHelper from \"../utils/eventhelper\";\r\nimport RafAction from \"../utils/rafaction\";\r\nconst template = document.createElement(\"template\");\r\ntemplate.innerHTML = `\r\n <div class=\"inner popover fade show bs-popover-right\" role=\"tooltip\" style=\"position: absolute; left: 0px; top: 0px\">\r\n    <div class=\"arrow\" style=\"top: 34px;\"></div>\r\n    <h3 class=\"popover-header\">test</h3>\r\n    <div class=\"popover-body\">test</div>\r\n  </div>\r\n  <slot/>`;\r\nexport class PositionListener extends HTMLElement {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.listenedIdField = \"\";\r\n        this.positionChangingHandler = this.handlePositionChanging.bind(this);\r\n        this.rafAction = new RafAction();\r\n        this.innerElement = null;\r\n    }\r\n    get listenerId() {\r\n        return this.listenedIdField;\r\n    }\r\n    set listenerId(listenerId) {\r\n        this.listenedIdField = listenerId;\r\n    }\r\n    connectedCallback() {\r\n        const shadowRoot = this.attachShadow({ mode: \"open\" });\r\n        shadowRoot.appendChild(template.content.cloneNode(true));\r\n        this.addEventListener(PositionChangingEvent.eventName, this.positionChangingHandler);\r\n        window.addEventListener(PositionChangingEvent.eventName, this.positionChangingHandler);\r\n    }\r\n    disconnectedCallback() {\r\n    }\r\n    static get observedAttributes() {\r\n        return [\"listener-id\"];\r\n    }\r\n    attributeChangedCallback(name, oldVal, newVal) {\r\n        switch (name) {\r\n            case \"listener-id\":\r\n                this.listenerIdChanged(newVal);\r\n        }\r\n    }\r\n    listenerIdChanged(newVal) {\r\n        this.listenerId = newVal;\r\n    }\r\n    handlePositionChanging(ev) {\r\n        if (!this.listenerId)\r\n            return;\r\n        if (ev.detail.Tracker.listenerId !== this.listenerId)\r\n            return;\r\n        EventHelper.markHandled(ev);\r\n        if (!this.innerElement) {\r\n            this.innerElement = this.shadowRoot.querySelector(\".inner\");\r\n            if (!this.innerElement)\r\n                return;\r\n            const body = this.closest(\"body\");\r\n            body.appendChild(this.innerElement);\r\n        }\r\n        const rect = ev.detail.Tracker.getTargetBoundingClientRect();\r\n        this.innerElement.style.transform = [\"translate(\", Math.round(rect.x + rect.width), \"px, \", Math.round(rect.y), \"px)\"].join(\"\");\r\n    }\r\n}\r\ncustomElements.define(\"dxbl-position-listener\", PositionListener);\r\nexport function init() {\r\n}\r\nexport default { init, PositionListener };\r\n"],"names":[],"mappings":"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"}