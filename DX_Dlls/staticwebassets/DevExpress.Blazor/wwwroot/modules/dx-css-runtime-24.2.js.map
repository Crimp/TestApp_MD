{"version":3,"file":"dx-css-runtime-24.2.js","sources":["../../Scripts/dx-css-runtime.ts"],"sourcesContent":["class CalculatedCssPropertyMapping {\r\n    constructor(defaultValueSource, computedValueSource, valueDestination) {\r\n        this.defaultValueSource = defaultValueSource;\r\n        this.computedValueSource = computedValueSource;\r\n        this.valueDestination = valueDestination;\r\n    }\r\n}\r\nconst calculatedProperties = [\r\n    new CalculatedCssPropertyMapping(\"--bs-body-bg\", \"background-color\", \"--dxbl-body-bg\"),\r\n    new CalculatedCssPropertyMapping(\"--bs-body-color\", \"color\", \"--dxbl-body-color\")\r\n];\r\nconst BsCssVariableNames = [\"--primary\", \"--bs-primary\"];\r\nconst BsCssVariableRetrieveRetryCount = 50;\r\nconst BsCssVariableRetrieveAttemptDelayMs = 200;\r\nfunction initializeThemeCssRuntimeVariablesCore() {\r\n    const element = document.body;\r\n    const styles = window.getComputedStyle(element);\r\n    calculatedProperties.forEach(x => {\r\n        element.style.removeProperty(x.valueDestination);\r\n    });\r\n    calculatedProperties\r\n        .filter(x => !styles.getPropertyValue(x.defaultValueSource))\r\n        .forEach(x => {\r\n        element.style.setProperty(x.valueDestination, styles.getPropertyValue(x.computedValueSource));\r\n    });\r\n}\r\nfunction waitForBs4Load(resolveAction, retryCount) {\r\n    if (retryCount === 0)\r\n        return resolveAction();\r\n    const styles = window.getComputedStyle(document.body);\r\n    const isBsVariablesLoaded = BsCssVariableNames\r\n        .map(x => !!styles.getPropertyValue(x))\r\n        .reduce((prevValue, currValue) => prevValue || currValue, false);\r\n    if (isBsVariablesLoaded)\r\n        return resolveAction();\r\n    setTimeout(() => waitForBs4Load(resolveAction, retryCount - 1), BsCssVariableRetrieveAttemptDelayMs);\r\n}\r\nfunction createIFramePromise() {\r\n    return new Promise((resolve, _) => {\r\n        const hiddenIFrame = document.createElement(\"IFRAME\");\r\n        hiddenIFrame.style.cssText = \"position: absolute; display: none; top: -10000px; left: -10000px;\";\r\n        hiddenIFrame.onload = () => {\r\n            resolve(hiddenIFrame);\r\n        };\r\n        document.body.appendChild(hiddenIFrame);\r\n    });\r\n}\r\nlet hiddenIFramePromise = createIFramePromise();\r\nasync function getHiddenIFramePromise() {\r\n    const iframe = await hiddenIFramePromise;\r\n    if (!iframe.parentNode) {\r\n        hiddenIFramePromise = createIFramePromise();\r\n        return await hiddenIFramePromise;\r\n    }\r\n    return iframe;\r\n}\r\nfunction safeFetch(url) {\r\n    return new Promise((resolve, _) => {\r\n        getHiddenIFramePromise().then((hiddenIFrame) => {\r\n            const doc = hiddenIFrame.contentDocument;\r\n            const linkElement = doc.createElement(\"link\");\r\n            linkElement.href = url;\r\n            linkElement.rel = \"stylesheet\";\r\n            linkElement.onload = () => {\r\n                resolve();\r\n                linkElement.remove();\r\n            };\r\n            linkElement.onerror = () => {\r\n                resolve();\r\n                linkElement.remove();\r\n            };\r\n            doc.head.appendChild(linkElement);\r\n        });\r\n    });\r\n}\r\nfunction ensureStylesheetLoadedAsync(href) {\r\n    return new Promise((resolve, _) => {\r\n        safeFetch(href).then(() => {\r\n            waitForBs4Load(resolve, BsCssVariableRetrieveRetryCount);\r\n        });\r\n    });\r\n}\r\nasync function tryEnsureStylesheetLoadedAsync(node) {\r\n    if (node.nodeType === Node.ELEMENT_NODE) {\r\n        const element = node;\r\n        if (element.tagName === \"LINK\") {\r\n            const linkElement = element;\r\n            if (linkElement.rel === \"stylesheet\") {\r\n                await ensureStylesheetLoadedAsync(linkElement.href);\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction ensureRuntimeStylesInvalidated(node) {\r\n    tryEnsureStylesheetLoadedAsync(node)\r\n        .then(isStylesheet => {\r\n        if (isStylesheet)\r\n            initializeThemeCssRuntimeVariablesCore();\r\n    });\r\n}\r\nfunction initializeThemeCssRuntimeVariables() {\r\n    const target = document.head;\r\n    const config = {\r\n        attributes: true,\r\n        childList: true,\r\n        subtree: true\r\n    };\r\n    const observer = new MutationObserver((mutations, _) => {\r\n        for (const mutation of mutations) {\r\n            if (mutation.type === \"childList\" && mutation.addedNodes)\r\n                mutation.addedNodes.forEach(ensureRuntimeStylesInvalidated);\r\n            else if (mutation.type === \"attributes\" && mutation.attributeName === \"href\")\r\n                ensureRuntimeStylesInvalidated(mutation.target);\r\n        }\r\n    });\r\n    observer.observe(target, config);\r\n    Promise\r\n        .all(Array.from(document.head.childNodes)\r\n        .map(x => tryEnsureStylesheetLoadedAsync(x)))\r\n        .then(() => initializeThemeCssRuntimeVariablesCore());\r\n}\r\nexport default { initializeThemeCssRuntimeVariables };\r\n"],"names":[],"mappings":"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"}